DROP SCHEMA IF EXISTS "TEJASTORE" CASCADE;
CREATE SCHEMA "TEJASTORE";
SET search_path='TEJASTORE';

DROP TABLE IF EXISTS "ARTICULO" CASCADE;

CREATE TABLE "ARTICULO"(
 "CODIGO" SERIAL UNIQUE NOT NULL,
 "NOMBRE" varchar(50),
 "PRECIO_COMPRA" float,
 "PRECIO_VENTA" float,
 "STOCK_MIN" integer,
 "STOCK_MAX" integer,
 PRIMARY KEY ("CODIGO"));

DROP TABLE IF EXISTS "EMPRESA" CASCADE;

CREATE TABLE "EMPRESA"(
 "CUIT" varchar(50) NOT NULL,
 "NOMBRE" varchar(50),
 "EMAIL" varchar(50),
PRIMARY KEY ("CUIT"));

DROP TABLE IF EXISTS "TURNO" CASCADE;
CREATE TABLE "TURNO"(
 "ID" varchar(50) NOT NULL,
 "H_ENTRADA" date,
 "H_SALIDA" date,
 PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS "PERSONA" CASCADE;
CREATE TABLE "PERSONA"(
 "DNI" varchar(50) NOT NULL,
 "NOMBRE" varchar(100),
 "APELLIDO" varchar(50),
 "EMAIL" varchar(50),
 "CUIL" varchar(50),
 "FECHA_NACIMIENTO" varchar(50),
 PRIMARY KEY ("DNI"));

DROP TABLE IF EXISTS "TELEFONO" CASCADE;
CREATE TABLE "TELEFONO"(
 "NUMERO" varchar(50) NOT NULL,
 "CODIGO" varchar(50),
 "TIPO" varchar(50),
 "CUIT" varchar(50) NOT NULL,
FOREIGN KEY ("CUIT") REFERENCES "EMPRESA"("CUIT"),
PRIMARY KEY ("NUMERO"));

DROP TABLE IF EXISTS "REL4" CASCADE;
CREATE TABLE "REL4"(
 "ID" varchar(50) NOT NULL,
 "DNI" varchar(50) NOT NULL,
FOREIGN KEY ("ID") REFERENCES "TURNO" ("ID"),
FOREIGN KEY ("DNI") REFERENCES "PERSONA" ("DNI"),
PRIMARY KEY ("ID","DNI"));

DROP TABLE IF EXISTS "EMPLEADO" CASCADE;
CREATE TABLE "EMPLEADO"(
 "DNI" varchar(50) NOT NULL,
FOREIGN KEY ("DNI") REFERENCES "PERSONA" ("DNI"),
PRIMARY KEY ("DNI"));

DROP TABLE IF EXISTS "GERENTE";
CREATE TABLE "GERENTE"(
 "DNI" varchar(50) NOT NULL,
FOREIGN KEY ("DNI") REFERENCES "PERSONA"("DNI"),
PRIMARY KEY ("DNI"));

DROP TABLE IF EXISTS "PAIS" CASCADE;
CREATE TABLE "PAIS"(
 "ID" varchar(50) NOT NULL,
 "NOMBRE" varchar(50),
PRIMARY KEY("ID"));

DROP TABLE IF EXISTS "RUBRO" CASCADE;
CREATE TABLE "RUBRO"(
 "ID" varchar(50) NOT NULL,
 "NOMBRE" varchar(50),
PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS "REL8" CASCADE;
CREATE TABLE "REL8"(
 "CODIGO" SERIAL NOT NULL,
 "CUIT" varchar(50) NOT NULL,
FOREIGN KEY ("CODIGO") REFERENCES "ARTICULO" ("CODIGO"),
FOREIGN KEY ("CUIT") REFERENCES "EMPRESA" ("CUIT"),
PRIMARY KEY ("CODIGO","CUIT"));

DROP TABLE IF EXISTS "VENTA" CASCADE;
CREATE TABLE "VENTA"(
 "ID" varchar(50) NOT NULL,
 "MONTO" varchar(50),
 "HORARIO" varchar(50),
 "DNI" varchar(50) NOT NULL,
FOREIGN KEY ("DNI") REFERENCES "PERSONA" ("DNI"),
PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS "CONTIENE" CASCADE;
CREATE TABLE "CONTIENE"(
 "CODIGO" SERIAL NOT NULL,
 "ID" varchar(50) NOT NULL,
 "CANT" integer NOT NULL,
FOREIGN KEY ("CODIGO") REFERENCES "ARTICULO" ("CODIGO"),
FOREIGN KEY ("ID") REFERENCES "VENTA" ("ID"),
PRIMARY KEY ("CODIGO","ID"));

DROP TABLE IF EXISTS "REL11" CASCADE;
CREATE TABLE "REL11"(
 "CODIGO" serial NOT NULL,
 "ID" varchar(50) NOT NULL,
FOREIGN KEY ("CODIGO") REFERENCES "ARTICULO" ("CODIGO"),
FOREIGN KEY ("ID") REFERENCES "RUBRO" ("ID"),
PRIMARY KEY ("CODIGO","ID"));

DROP TABLE IF EXISTS "PROVINCIA" CASCADE;
CREATE TABLE "PROVINCIA"(
 "ID" varchar(50) NOT NULL,
 "NOMBRE" varchar(50),
 "PAIS_ID" varchar(50) NOT NULL,
 FOREIGN KEY ("PAIS_ID") REFERENCES "PAIS"("ID"),
PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS  "LOCALIDAD" CASCADE;
CREATE TABLE "LOCALIDAD"(
 "ID" varchar(50) NOT NULL,
 "NOMBRE" varchar(50),
 "PROVINCIA_ID" varchar(50) NOT NULL,
 FOREIGN KEY ("PROVINCIA_ID") REFERENCES "PROVINCIA" ("ID"),
 PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS "CALLE" CASCADE;
CREATE TABLE "CALLE"(
 "ID" varchar(50) NOT NULL,
 "NUM" integer,
 "NOMBRE" varchar(50),
 "LOCALIDAD_ID" varchar(50) NOT NULL,
 FOREIGN KEY ("LOCALIDAD_ID") REFERENCES "LOCALIDAD" ("ID"),
 PRIMARY KEY ("ID"));

DROP TABLE IF EXISTS "DIRECCION" CASCADE;
CREATE TABLE "DIRECCION"(
 "CUIT" varchar(50) NOT NULL,
 "ID" varchar(50) NOT NULL,
FOREIGN KEY ("CUIT") REFERENCES "EMPRESA" ("CUIT"),
FOREIGN KEY ("ID") REFERENCES "CALLE" ("ID"),
PRIMARY KEY ("CUIT","ID"));

DROP TABLE IF EXISTS "VIVE" CASCADE;
CREATE TABLE "VIVE"(
 "ID" varchar(50) NOT NULL,
 "DNI" varchar(50) NOT NULL,
 FOREIGN KEY ("ID") REFERENCES "CALLE" ("ID"),
 FOREIGN KEY ("DNI") REFERENCES "PERSONA"("DNI"),
 PRIMARY KEY ("ID","DNI"));


